<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
  <meta charset="utf-8">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
</head>
<body class="bg-[#f5f1e8] min-h-screen flex items-center justify-center font-['Inter',sans-serif]">
  <script>
    async function onClerkLoad() {
      try {
        await Clerk.load();
        if (Clerk.user) {
          // User is signed in, cookie should now be synced. Reload to let backend see it.
          // Append a timestamp to avoid cache
          const url = new URL(window.location.href);
          url.searchParams.set('_t', Date.now());
          window.location.href = url.toString();
        } else {
          // Not signed in, redirect to sign in flow
          window.location.href = "{{SIGN_IN_URL}}";
        }
      } catch (err) {
        console.error('Clerk load error', err);
        // Fallback
        window.location.href = "{{SIGN_IN_URL}}";
      }
    }

    // Fallback if onload doesn't trigger for some reason
    window.addEventListener('load', () => {
      if (window.Clerk && !window.Clerk.isReady && typeof onClerkLoad === 'function') {
        // Clerk script is there but maybe didn't call onClerkLoad
      }
    });
  </script>
  {{CLERK_SCRIPT}}

  <div class="text-center">
    <div class="inline-block w-8 h-8 border-4 border-accent border-t-transparent rounded-full animate-spin mb-4"></div>
    <p class="text-muted font-medium">Redirecting to authentication...</p>
  </div>
</body>
</html>

